import{S as Ne,i as Pe,s as Me,e as b,J as Ce,c as m,a as g,K as ke,d as u,b as s,g as G,F as t,G as U,H as Ae,t as M,k as V,h as B,m as N,X as A,Z as de,M as Be,N as Oe,O as De,_ as Ue,l as Ie,w as He,x as Fe,y as Ge,$ as le,q as Je,o as Qe,B as Re,L as ze,a4 as we,a0 as Ke,p as Xe,j as Ze,a1 as te,a2 as ne,n as We,a3 as Ye,a5 as xe}from"../chunks/vendor-1ec5dcfe.js";const $e={mysql:i=>"`"+i+"`",oracle:i=>'"'+i+'"',tsql:i=>"["+i+"]"};function el(i,e){const n=$e[e],o=(r,_)=>n(r)+"."+n(_),h=i.filter(r=>r.columns.length>0).flatMap(r=>r.columns.map(_=>`${o(r.table,_)} AS ${n(`${r.table}_${_}`)}`)),c=i.slice(1).map(r=>`JOIN ${n(r.table)} ON ${o(r.table,r.joinOn.column)} = ${o(r.joinOn.refTable,r.joinOn.refColumn)}`);return`
SELECT
  ${h.join(`,
  `)}
FROM
  ${n(i[0].table)}
  ${c.join(`
  `)}
`}function Se(i){let e,n,o,h,c,a;return{c(){e=b("div"),n=b("span"),o=Ce("svg"),h=Ce("path"),this.h()},l(r){e=m(r,"DIV",{class:!0});var _=g(e);n=m(_,"SPAN",{});var j=g(n);o=ke(j,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0,xmlns:!0});var O=g(o);h=ke(O,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),g(h).forEach(u),O.forEach(u),j.forEach(u),_.forEach(u),this.h()},h(){s(h,"stroke-linecap","round"),s(h,"stroke-linejoin","round"),s(h,"stroke-width","2"),s(h,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),s(o,"class","w-6 h-6"),s(o,"fill","none"),s(o,"stroke","currentColor"),s(o,"viewBox","0 0 24 24"),s(o,"xmlns","http://www.w3.org/2000/svg"),s(e,"class","self-end text-slate-400 hover:text-slate-600 hover:cursor-pointer")},m(r,_){G(r,e,_),t(e,n),t(n,o),t(o,h),c||(a=U(n,"click",i[8]),c=!0)},p:Ae,d(r){r&&u(e),c=!1,a()}}}function qe(i){let e,n,o,h,c,a,r,_,j,O,L,k,T,S,P,I,l,f,d;return{c(){e=b("div"),n=b("div"),o=b("label"),h=M("Join on"),c=V(),a=b("div"),r=b("input"),_=V(),j=b("span"),O=M("="),L=V(),k=b("input"),T=V(),S=b("span"),P=M("."),I=V(),l=b("input"),this.h()},l(D){e=m(D,"DIV",{});var C=g(e);n=m(C,"DIV",{});var R=g(n);o=m(R,"LABEL",{});var w=g(o);h=B(w,"Join on"),w.forEach(u),R.forEach(u),c=N(C),a=m(C,"DIV",{class:!0});var p=g(a);r=m(p,"INPUT",{id:!0,type:!0,class:!0,placeholder:!0}),_=N(p),j=m(p,"SPAN",{});var E=g(j);O=B(E,"="),E.forEach(u),L=N(p),k=m(p,"INPUT",{id:!0,type:!0,class:!0,placeholder:!0}),T=N(p),S=m(p,"SPAN",{});var q=g(S);P=B(q,"."),q.forEach(u),I=N(p),l=m(p,"INPUT",{id:!0,type:!0,class:!0,placeholder:!0}),p.forEach(u),C.forEach(u),this.h()},h(){s(r,"id","joinOn"),s(r,"type","text"),s(r,"class","flex-1 py-1 px-2 rounded-t-md bg-gray-100 border-0 border-b-2 border-gray-200 focus:ring-0"),s(r,"placeholder","author_id"),s(k,"id","refTable"),s(k,"type","text"),s(k,"class","flex-1 py-1 px-2 rounded-t-md bg-gray-100 border-0 border-b-2 border-gray-200 focus:ring-0"),s(k,"placeholder","Author"),s(l,"id","refColumn"),s(l,"type","text"),s(l,"class","flex-1 py-1 px-2 rounded-t-md bg-gray-100 border-0 border-b-2 border-gray-200 focus:ring-0"),s(l,"placeholder","id"),s(a,"class","flex flex-row space-x-1 items-end")},m(D,C){G(D,e,C),t(e,n),t(n,o),t(o,h),t(e,c),t(e,a),t(a,r),A(r,i[1]),t(a,_),t(a,j),t(j,O),t(a,L),t(a,k),A(k,i[2]),t(a,T),t(a,S),t(S,P),t(a,I),t(a,l),A(l,i[3]),f||(d=[U(r,"input",i[12]),U(k,"input",i[13]),U(l,"input",i[14])],f=!0)},p(D,C){C&2&&r.value!==D[1]&&A(r,D[1]),C&4&&k.value!==D[2]&&A(k,D[2]),C&8&&l.value!==D[3]&&A(l,D[3])},d(D){D&&u(e),f=!1,de(d)}}}function ll(i){let e,n,o,h,c,a,r,_,j,O,L,k,T,S,P,I,l,f,d,D,C,R,w=!i[5]&&Se(i),p=!i[4]&&qe(i);return{c(){e=b("div"),w&&w.c(),n=V(),o=b("div"),h=b("div"),c=b("label"),a=M("Table"),r=V(),_=b("div"),j=b("input"),O=V(),L=b("div"),k=b("div"),T=b("label"),S=M("Columns"),P=V(),I=b("div"),l=b("input"),f=V(),p&&p.c(),this.h()},l(E){e=m(E,"DIV",{class:!0});var q=g(e);w&&w.l(q),n=N(q),o=m(q,"DIV",{});var z=g(o);h=m(z,"DIV",{});var Q=g(h);c=m(Q,"LABEL",{for:!0});var Z=g(c);a=B(Z,"Table"),Z.forEach(u),Q.forEach(u),r=N(z),_=m(z,"DIV",{});var X=g(_);j=m(X,"INPUT",{id:!0,type:!0,class:!0,placeholder:!0}),X.forEach(u),z.forEach(u),O=N(q),L=m(q,"DIV",{});var J=g(L);k=m(J,"DIV",{});var H=g(k);T=m(H,"LABEL",{for:!0});var W=g(T);S=B(W,"Columns"),W.forEach(u),H.forEach(u),P=N(J),I=m(J,"DIV",{});var Y=g(I);l=m(Y,"INPUT",{id:!0,type:!0,class:!0,placeholder:!0}),Y.forEach(u),J.forEach(u),f=N(q),p&&p.l(q),q.forEach(u),this.h()},h(){s(c,"for","table"),s(j,"id","table"),s(j,"type","text"),s(j,"class","w-full py-1 px-2 rounded-t-md bg-gray-100 border-0 border-b-2 border-gray-200 focus:ring-0"),s(j,"placeholder","Book"),s(T,"for","columns"),s(l,"id","columns"),s(l,"type","text"),s(l,"class","w-full py-1 px-2 rounded-t-md bg-gray-100 border-0 border-b-2 border-gray-200 focus:ring-0"),s(l,"placeholder","title, published_on"),s(e,"class","flex flex-col space-y-2 rounded-md shadow-lg p-2")},m(E,q){G(E,e,q),w&&w.m(e,null),t(e,n),t(e,o),t(o,h),t(h,c),t(c,a),t(o,r),t(o,_),t(_,j),A(j,i[0]),t(e,O),t(e,L),t(L,k),t(k,T),t(T,S),t(L,P),t(L,I),t(I,l),A(l,i[6]),t(e,f),p&&p.m(e,null),D=!0,C||(R=[U(j,"input",i[10]),U(l,"input",i[11]),U(l,"change",i[7])],C=!0)},p(E,[q]){E[5]?w&&(w.d(1),w=null):w?w.p(E,q):(w=Se(E),w.c(),w.m(e,n)),q&1&&j.value!==E[0]&&A(j,E[0]),q&64&&l.value!==E[6]&&A(l,E[6]),E[4]?p&&(p.d(1),p=null):p?p.p(E,q):(p=qe(E),p.c(),p.m(e,null))},i(E){D||(Be(()=>{d||(d=Oe(e,De,{},!0)),d.run(1)}),D=!0)},o(E){d||(d=Oe(e,De,{},!1)),d.run(0),D=!1},d(E){E&&u(e),w&&w.d(),p&&p.d(),E&&d&&d.end(),C=!1,de(R)}}}function tl(i,e,n){let{table:o=""}=e,{columns:h=[]}=e,c=h.join(", "),{joinColumn:a=""}=e,{refTable:r=""}=e,{refColumn:_=""}=e,{hideJoin:j=!1}=e,{hideDelete:O=!1}=e;const L=Ue();function k(){n(9,h=c.split(",").map(d=>d.trim()))}function T(){L("delete")}function S(){o=this.value,n(0,o)}function P(){c=this.value,n(6,c)}function I(){a=this.value,n(1,a)}function l(){r=this.value,n(2,r)}function f(){_=this.value,n(3,_)}return i.$$set=d=>{"table"in d&&n(0,o=d.table),"columns"in d&&n(9,h=d.columns),"joinColumn"in d&&n(1,a=d.joinColumn),"refTable"in d&&n(2,r=d.refTable),"refColumn"in d&&n(3,_=d.refColumn),"hideJoin"in d&&n(4,j=d.hideJoin),"hideDelete"in d&&n(5,O=d.hideDelete)},[o,a,r,_,j,O,c,k,T,h,S,P,I,l,f]}class nl extends Ne{constructor(e){super();Pe(this,e,tl,ll,Me,{table:0,columns:9,joinColumn:1,refTable:2,refColumn:3,hideJoin:4,hideDelete:5})}}function Le(i,e,n){const o=i.slice();return o[14]=e[n],o[15]=e,o[16]=n,o}function Ve(i,e){let n,o,h,c,a,r,_,j;function O(l){e[7](l,e[14])}function L(l){e[8](l,e[14])}function k(l){e[9](l,e[14])}function T(l){e[10](l,e[14])}function S(l){e[11](l,e[14])}function P(){return e[12](e[14])}let I={hideJoin:e[16]===0,hideDelete:e[16]===0};return e[14].table!==void 0&&(I.table=e[14].table),e[14].columns!==void 0&&(I.columns=e[14].columns),e[14].joinOn.column!==void 0&&(I.joinColumn=e[14].joinOn.column),e[14].joinOn.refTable!==void 0&&(I.refTable=e[14].joinOn.refTable),e[14].joinOn.refColumn!==void 0&&(I.refColumn=e[14].joinOn.refColumn),o=new nl({props:I}),te.push(()=>ne(o,"table",O)),te.push(()=>ne(o,"columns",L)),te.push(()=>ne(o,"joinColumn",k)),te.push(()=>ne(o,"refTable",T)),te.push(()=>ne(o,"refColumn",S)),o.$on("delete",P),{key:i,first:null,c(){n=Ie(),He(o.$$.fragment),this.h()},l(l){n=Ie(),Fe(o.$$.fragment,l),this.h()},h(){this.first=n},m(l,f){G(l,n,f),Ge(o,l,f),j=!0},p(l,f){e=l;const d={};f&4&&(d.hideJoin=e[16]===0),f&4&&(d.hideDelete=e[16]===0),!h&&f&4&&(h=!0,d.table=e[14].table,le(()=>h=!1)),!c&&f&4&&(c=!0,d.columns=e[14].columns,le(()=>c=!1)),!a&&f&4&&(a=!0,d.joinColumn=e[14].joinOn.column,le(()=>a=!1)),!r&&f&4&&(r=!0,d.refTable=e[14].joinOn.refTable,le(()=>r=!1)),!_&&f&4&&(_=!0,d.refColumn=e[14].joinOn.refColumn,le(()=>_=!1)),o.$set(d)},i(l){j||(Je(o.$$.fragment,l),j=!0)},o(l){Qe(o.$$.fragment,l),j=!1},d(l){l&&u(n),Re(o,l)}}}function ol(i){let e,n,o,h,c,a,r,_,j,O,L,k,T,S,P,I,l,f,d,D,C=[],R=new Map,w,p,E,q,z,Q,Z,X,J,H,W,Y,x,oe,$,se,ce,ee=i[2];const _e=v=>v[14].id;for(let v=0;v<ee.length;v+=1){let y=Le(i,ee,v),F=_e(y);R.set(F,C[v]=Ve(F,y))}return{c(){e=b("div"),n=b("h2"),o=M("SQL Dialect"),h=V(),c=b("select"),a=b("option"),r=M("MySQL / MaiaDB"),_=b("option"),j=M("Oracle"),O=b("option"),L=M("TSQL (MS SQL Server)"),k=V(),T=b("div"),S=b("h2"),P=M("Tables"),I=V(),l=b("div"),f=M(fe),d=V(),D=b("div");for(let v=0;v<C.length;v+=1)C[v].c();w=V(),p=b("div"),E=b("button"),q=M("add table"),z=V(),Q=b("button"),Z=M("generate"),X=V(),J=b("div"),H=b("h2"),W=M("Generated SQL"),Y=V(),x=b("pre"),oe=M(i[0]),this.h()},l(v){e=m(v,"DIV",{class:!0});var y=g(e);n=m(y,"H2",{class:!0});var F=g(n);o=B(F,"SQL Dialect"),F.forEach(u),h=N(y),c=m(y,"SELECT",{});var ae=g(c);a=m(ae,"OPTION",{});var he=g(a);r=B(he,"MySQL / MaiaDB"),he.forEach(u),_=m(ae,"OPTION",{});var be=g(_);j=B(be,"Oracle"),be.forEach(u),O=m(ae,"OPTION",{});var me=g(O);L=B(me,"TSQL (MS SQL Server)"),me.forEach(u),ae.forEach(u),y.forEach(u),k=N(v),T=m(v,"DIV",{class:!0});var K=g(T);S=m(K,"H2",{class:!0});var pe=g(S);P=B(pe,"Tables"),pe.forEach(u),I=N(K),l=m(K,"DIV",{class:!0});var ve=g(l);f=B(ve,fe),ve.forEach(u),d=N(K),D=m(K,"DIV",{class:!0});var ge=g(D);for(let ue=0;ue<C.length;ue+=1)C[ue].l(ge);ge.forEach(u),w=N(K),p=m(K,"DIV",{class:!0});var ie=g(p);E=m(ie,"BUTTON",{class:!0});var je=g(E);q=B(je,"add table"),je.forEach(u),z=N(ie),Q=m(ie,"BUTTON",{class:!0});var Te=g(Q);Z=B(Te,"generate"),Te.forEach(u),ie.forEach(u),K.forEach(u),X=N(v),J=m(v,"DIV",{class:!0});var re=g(J);H=m(re,"H2",{class:!0});var Ee=g(H);W=B(Ee,"Generated SQL"),Ee.forEach(u),Y=N(re),x=m(re,"PRE",{class:!0});var ye=g(x);oe=B(ye,i[0]),ye.forEach(u),re.forEach(u),this.h()},h(){s(n,"class","my-2 text-sky-600 text-4xl"),a.__value="mysql",a.value=a.__value,_.__value="oracle",_.value=_.__value,O.__value="tsql",O.value=O.__value,i[1]===void 0&&Be(()=>i[6].call(c)),s(e,"class","shadow-lg p-4"),s(S,"class","my-2 text-sky-600 text-4xl"),s(l,"class","my-4 p-2 border-red-800 border-2 rounded-lg text-red-800"),ze(l,"hidden",fe.length===0),s(D,"class","flex flex-col space-y-2"),s(E,"class","py-2 px-4 uppercase rounded-lg bg-sky-600 text-white"),s(Q,"class","py-2 px-4 uppercase rounded-lg bg-sky-600 text-white"),s(p,"class","flex flex-row justify-between mt-4"),s(T,"class","shadow-lg p-4"),s(H,"class","my-2 text-sky-600 text-4xl"),s(x,"class","w-full h-60 font-mono text-gray-800 bg-gray-50 p-2 overflow-scroll"),s(J,"class","shadow-lg p-4")},m(v,y){G(v,e,y),t(e,n),t(n,o),t(e,h),t(e,c),t(c,a),t(a,r),t(c,_),t(_,j),t(c,O),t(O,L),we(c,i[1]),G(v,k,y),G(v,T,y),t(T,S),t(S,P),t(T,I),t(T,l),t(l,f),t(T,d),t(T,D);for(let F=0;F<C.length;F+=1)C[F].m(D,null);t(T,w),t(T,p),t(p,E),t(E,q),t(p,z),t(p,Q),t(Q,Z),G(v,X,y),G(v,J,y),t(J,H),t(H,W),t(J,Y),t(J,x),t(x,oe),$=!0,se||(ce=[U(c,"change",i[6]),U(E,"click",i[3]),U(Q,"click",i[5])],se=!0)},p(v,[y]){y&2&&we(c,v[1]),y&20&&(ee=v[2],We(),C=Ke(C,y,_e,1,v,ee,R,D,Ye,Ve,null,Le),Xe()),(!$||y&1)&&Ze(oe,v[0])},i(v){if(!$){for(let y=0;y<ee.length;y+=1)Je(C[y]);$=!0}},o(v){for(let y=0;y<C.length;y+=1)Qe(C[y]);$=!1},d(v){v&&u(e),v&&u(k),v&&u(T);for(let y=0;y<C.length;y+=1)C[y].d();v&&u(X),v&&u(J),se=!1,de(ce)}}}const rl=()=>({stuff:{pageTitle:"Pivot Table for SQL"}});let fe="";function al(i,e,n){let o="",h="mysql",c=0,a=[{id:c++,table:"Author",columns:["name","year_of_birth"],joinOn:{column:"",refTable:"",refColumn:""}}];function r(){n(2,a=[...a,{id:c++,table:"",columns:[],joinOn:{column:"",refTable:"",refColumn:""}}])}r();function _(l){const f=a.findIndex(d=>d.id===l);f<0||n(2,a=[...a.slice(0,f),...a.slice(f+1)])}function j(){n(0,o=el(a,h))}function O(){h=xe(this),n(1,h)}function L(l,f){i.$$.not_equal(f.table,l)&&(f.table=l,n(2,a))}function k(l,f){i.$$.not_equal(f.columns,l)&&(f.columns=l,n(2,a))}function T(l,f){i.$$.not_equal(f.joinOn.column,l)&&(f.joinOn.column=l,n(2,a))}function S(l,f){i.$$.not_equal(f.joinOn.refTable,l)&&(f.joinOn.refTable=l,n(2,a))}function P(l,f){i.$$.not_equal(f.joinOn.refColumn,l)&&(f.joinOn.refColumn=l,n(2,a))}return[o,h,a,r,_,j,O,L,k,T,S,P,l=>_(l.id)]}class sl extends Ne{constructor(e){super();Pe(this,e,al,ol,Me,{})}}export{sl as default,rl as load};
